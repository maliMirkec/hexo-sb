<p>I've been working on a complex Angular <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a>-ish project recently and one of the requirements was to create a form based on an <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC</a> model. This model was not definite and could vary depending on many parameters in the application. As a result, I've created a directive that could generate a form for every complex model. Final code is available on <a href="https://github.com/maliMirkec/angular-repeater">Github repository</a> and it's called <strong>angular-repeater</strong>. Demo is available <a href="https://frontend-developer.xyz/angular-repeater/">here</a>.</p>
<!-- more -->
<h2>Digression</h2>
<p>Sometimes the amount of new frontend technologies feels really <a href="https://hackernoon.com/how-it-feels-to-learn-javascript-in-2016-d3a717dd577f#.h9purwu1w">overwhelming to me</a>. Everybody is writing about these shinny new frameworks, but there are plenty of applications that are still using &quot;old&quot; technologies (that are not <em>that</em> old). Nobody is writing about them anymore. This is a solution for Angular 1.</p>
<h2>Angular Model</h2>
<p>Let's go back to the code. Even better, let's consider model examples for this task:</p>
<blockquote>
<p>{cldnry first-model-for-angular-repeater_bmsaac.png &quot;First model for angular repeater.&quot; %}</p>
</blockquote>
<blockquote>
<p>{cldnry second-model-for-angular-repeater_lxgczj.png &quot;Second model for angular repeater.&quot; %}</p>
</blockquote>
<blockquote>
<p>{cldnry third-model-for-angular-repeater_dsleyg.png &quot;Third model for angular repeater.&quot; %}</p>
</blockquote>
<p>These models contain typical types of data:</p>
<ul>
<li>strings,</li>
<li>integers,</li>
<li>floats,</li>
<li>arrays and</li>
<li>objects.</li>
</ul>
<h2>Recursion problem</h2>
<p>Since we need to iterate through these models to display labels and inputs, we should create at least 3 templates for them because they are formatted differently. That seems like a lot of work. Therefore that doesn't sound like the correct solution. Finally, if we try to iterate a model using <strong>ng-repeat</strong> directive and display every property as an input, we would repeat the code for every property. As a result we'll end up with a bloated and very ugly code.</p>
<p>The solution lies in <strong>recursion</strong>. It is a programming principle when a function calls itself. In our case, we'll use a <strong>recursive-repeater</strong> directive that will call itself.</p>
<blockquote>
<p>{cldnry angular-repeater-template_pzfvoq.png &quot;Template for angular repeater.&quot; %}</p>
</blockquote>
<p><em>For now, ignore IsObject() and IsNumber() functions.</em></p>
<p>If we run this code, we'll get an error. This is because Angular 1 doesn't support recursively included directives out of the box. But there is a solution.</p>
<h2>Recursion helper</h2>
<p>The solution is <a href="https://github.com/marklagendijk/angular-recursion">Mark Lagendijk's RecursionHelper service</a> that makes it possible to have recursive Angular directives.</p>
<p>I've already included this awesome service in <strong>recursive-repeater</strong> directive, like this:</p>
<blockquote>
<p>{cldnry angular-repeater-directive_rkx8sy.png &quot;Angular repeater directive.&quot; %}</p>
</blockquote>
<p>As you could see, we're not using <strong>link</strong> property when defining directive, we are using <strong>compile</strong> instead.</p>
<p>This directive works only when <strong>jsonData</strong> is provided via <strong>json-data</strong> attribute. <strong>label</strong> attribute is optional and is used to display label for every input. You could see an example in a <a href="#AngularRepeaterTemplate">previous section</a>.</p>
<p>In addition, there are 2 helper functions in a directive:</p>
<ul>
<li>IsObject() - used to check model property type and</li>
<li>IsNumber() - used to check if model property key is a number.</li>
</ul>
<h3>Important notice</h3>
<p>The last one is used to decide whether an object property is a regular array. If so, then the name of the input will end with '[]' characters resulting with correctly submitted form. If not, object is provided and the name of the input will be formatted like this: <code>label[objectKey]</code>. This is very important when submitting data to server, as many programming languages cannot read form data that is not formatted in fore-mentioned fashion.</p>
<h2>Final thought</h2>
<p>There you have it, recursively includible Angular directive.</p>
<p>This particular directive is used to display label and input for every model property. I'm considering to extend this functionality and allow user to define any other output.</p>
<p>I'm also considering to compare this technique with other popular frameworks, like <a href="https://vuejs.org/">Vue.js</a>, <a href="https://angular.io/">Angular 2</a> and <a href="https://facebook.github.io/react/">React</a>.</p>
<p>Please let me know what do you think, leave a comment bellow or <a href="https://twitter.com/malimirkeccita">tweet me</a>.</p>
